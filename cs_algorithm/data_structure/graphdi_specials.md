#	有向图衍生

##	Flow Network

流量网络

-	包含一个源点：物质流唯一出发点
-	包含一个汇点：物质流唯一汇聚点
-	每条有向边权重为边capacity的正整数$u_{ij}$
	-	事实上，有理数总可以通过变换变为整数，所以只要容量为
		有理数就可以
	-	计算机无法真正处理无理数，无理数边权只具有理论意义

###	流量约束

####	Capacity Constraits

容量约束：通过边的流量不大于边容量$x_{ij} \leqslant u_{ij}$

####	Flow-Conservation Requirement

流量守恒要求：除源点、汇点外其余顶点只能改变流方向，进入、
流出物质总量不变，不能消耗、添加物质

$$
\sum_{i:(i,j) \in E} x_{ij} = \sum_{k:(j,k) \in E} x_{jk}
$$

-	其中$x_{ij}$表示通过边$(i,j)$的流量（传输量）
-	等式左右为进入、离开顶点i的输入、输出流总和

并且

$$
\sum_{j:(1,j) \in E} x_{1j} = \sum_{i:(i,n) \in E} x_{in}
$$

-	流的值 = 源点输出流 = 汇点输入流
-	可通过流量守恒要求推出

###	最大流

分配流量网络中边权（实际流量），使得网络在满足流量守恒、容量
束情况下，最大的流的值（边容量都为正整数）

$$
\max = \sum_{j:(1,j)} x_{i,j} \\
s.t. 0 \leqslant x_{ij} \leqslant u_{ij} \\
\sum_{j:(j,i) \in E) x_{ji} - \sum_{j:(i,j) \in E} x_{ij} = 0
$$

###	Augmenting-Path Method

####	Augmenting-Path

**流量增益**路径：当前流情况下，可以传输更多流量、从源点到
汇点路径，考虑路径$i \rightarrow j \leftarrow k$中顶点j边

-	*forward edge*：前向边$(i, j)$，同流量网络中边$(i, j)$
	方向相同

	-	具有正的未使用容量$r_{ij} = u_{ij} - x_{ij}$
	-	可以把该边流量增加最多$r_{ij}$

-	*backward edge*：后向边$(j, k)$，同流量网络中边$(k, j)$
	方向相反

	-	具有正流量$x_{kj}$
	-	可以把该边流量减少最多$x_{kj}$

####	增益路径法

-	寻找网络中增益路径，设$r$为路径中各前向边未使用容量
	$r_{ij}$、后向边流量$x_{jk}$最小值

-	每条前向边流量加r、后向边流量减r，可以得到新的可行流量，
	且流量值增加r，不断迭代

-	基于边容量、流量都为正整数假设

	-	r也为正整数，每次迭代流量值至少增加1

	-	流量最大值有上界为源点为起点边容量和，则增益路径法
		在**有限步迭代后会停止**
	
-	联合最大流-最小割定律可以证明

	-	最终流量一定是最大化的，等于最小割容量
	-	和增量路径选择无关

-	最后一步迭代中

	-	所有已标记顶点和未标记顶点之间边就构成最小割
	-	这样边流量要么满（标记到未标记）、要么空（反）

> - 增益路径法具体实现参见*graph*
> - 算法主要问题在于如何寻找增益路径，生成路径的顺序对算法
	有巨大影响

###	Max-Flow Min-Cut Theorem

最大流-最小割定理：网络中最大流量值等于其最小割容量

####	Theorem1

网络中最大流量值小于任意割容量

-	设可行流量x值为v，割$C(X, \bar_X)$容量为c

-	通过该割的流量为：*$X$到$\bar_X$的流量之和*与
	*$\bar_X$到$X$的流量之和*的差值（可由流量守恒推导）

	$$
	v = \sum_{i \in X, j \in \bar_X} x_{ij} -
		\sum{j \in \bar_X, i \in X} x_{ji}
	$$

-	由流量非负可得

	$$
	v \leqslant \sum_{i \in X, j \in \bar_X} x_{ij}
		\leqslant \sum_{i \in X, j \in \bar_x} u_{ij}
	$$

	即网络上任何可行流值不能超过网络上任意割容量

	$$v \leqslant c$$

####	Theorem2

网络中最大流量等于最小割容量，可以使用增益路径法证明

-	设$v^{*}$为通过路径增益法得到的最终流$x^{*}$的值

-	对增益路径法最终流量情况下，考虑顶点集合$X^{*}$
	-	包含源点
	-	其他顶点可由源点出发，经未使用的容量大于0的前向边、
		流量大于0的后向边组成路径到达

-	则汇点不属于$X^{*}$，否则存在一条流量增益路径，不是流量
	增益法最终流情况

-	考虑割$C(X^{*}, \bar_{X^{*}})$

	-	$X^{*}, \bar_{X^{*}}$之间任意边$(i,j)$：
		$x_{ij} = u_{ij}$，没有未使用容量

	-	$\bar_{X^{*}}, X^{*}$之间任意边$(j,i)$：$x_{ji}=0$，
		没有流量

	-	否则顶点j$\in X^{*}$
	
-	则有

	$$\begin{align}{c}
	v* & = \sum_{i \in X^{*}, j \in \bar_{X^{*}} x_{ij} -
		\sum{j \in \bar_{X^{*}, i \in X^{*}} x_{ji} \\

	& = \sum_{i \in X^{*}, j \in \bar_{X^{*}}} u_{ij} - 0 \\

	& = C(X^{*}, \bar_{X^{*}})
	\end{align}$$

	即存在某个割容量等于流量增益法得到最终流量值

